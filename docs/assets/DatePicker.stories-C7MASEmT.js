import{j as v}from"./tslib.es6-gXVSDp23.js";import"./index-D3dIwoLr.js";import{r as f}from"./index-uubelm5h.js";import{D as Ae}from"./index-DolbdbGM.js";import{p as b}from"./typography.es-zceevOJ_.js";import{P as Ve,r as R,p as Te}from"./ChevronRightOutline-DAmKuVUD.js";import{u as ke,D as Le,a as Ne}from"./DropdownProvider.es-CSByVTCf.js";import{B as Fe,d as H}from"./index-B-lRfg65.js";import{W as Me,d as te,T as ne}from"./common-DvMQaCWA.js";import"./index-CEeWF_8x.js";import"./index-BB6V8Vwr.js";import"./index-MLNV-xYt.js";import"./index-Dei0BBcc.js";import"./index-Dum229H0.js";import"./index--r0xEzHu.js";import"./index-DFy_Fcck.js";import"./index-KdvgB-i8.js";import"./index-kQ-c6TeZ.js";import"./index-BUlkrEmc.js";function Pe(e,t){return e.value!==t.value||e.selectionStart!==t.selectionStart||e.selectionEnd!==t.selectionEnd}function Re(e,t){var r;const{value:s=e.value,selectionStart:n,selectionEnd:o}=t;if(Pe(e,{value:s,selectionStart:n,selectionEnd:o})){const i=(r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"value"))==null?void 0:r.set;let u;i==null||i.call(e,s),typeof n=="number"&&typeof o=="number"&&e.setSelectionRange(n,o),typeof Event=="function"?u=new Event("input",{bubbles:!0}):(u=document.createEvent("Event"),u.initEvent("input",!0,!0)),e.dispatchEvent(u)}}const Be=(e,t)=>{const s=f.useCallback(n=>{e.every(o=>o.current&&!o.current.contains(n.target))&&t(n)},[t,e]);f.useEffect(()=>(document.addEventListener("mousedown",s,!0),document.addEventListener("touchstart",s),()=>{document.removeEventListener("mousedown",s,!0),document.removeEventListener("touchstart",s)}),[s])};function je(e,t){const s=f.useRef(null),n=f.useRef(e);return f.useEffect(()=>{n.current=e},[e]),f.useEffect(()=>(s.current=window.setInterval(()=>n.current(),t),()=>window.clearInterval(s.current||0)),[t]),s}const Oe=b.div`
  pointer-events: initial;
  margin: 8px 0;
  flex: 0 0 auto;
  ${e=>e.$alignSelf?`align-self: ${e.$alignSelf};`:""};
  max-width: calc(100vw - 32px);
  opacity: 0;
  transition-delay: 200ms;
  transition-property: opacity;

  &:focus-visible {
    border: 2px solid blue;
  }

  ${e=>e.$dropContainerCssMixin}
`,We=b.div`
  pointer-events: none;
  height: 100%;
  flex: 0 0 auto;
`,He=b(Ve)`
  display: flex;
  flex-direction: ${e=>e.$reverse?"column-reverse":"column"};
  flex-wrap: nowrap;
`,pe=f.forwardRef(({targetRef:e,targetElement:t,onClickOutside:s=()=>null,className:n="",alignSelf:o,dropContainerCssMixin:r,...i},u)=>{const a=f.useRef(null),[l,c]=f.useState(!1),d=t??(e==null?void 0:e.current),{addDropdown:p,removeDropdown:g,dropdowns:E}=ke(a),{rootRef:x}=f.useContext(Le);Be([a],m=>{Ne(m,E)&&s(m)}),f.useLayoutEffect(()=>{var m;a.current!==document.activeElement&&((m=a==null?void 0:a.current)==null||m.focus())},[]);const y=f.useCallback(()=>{const m=a.current;if(m&&d){const S=m.getBoundingClientRect(),w=d.getBoundingClientRect(),C=window.innerHeight,A=window.innerWidth;if(C-S.bottom<0&&w.top>C-w.bottom?l||c(!0):(w.bottom+(w.top-S.top)<C-8||w.top<C-w.bottom)&&l&&c(!1),o&&o!=="auto")return;const I=S.right-S.left,V=A-w.left>=I,T=w.right-16>=I,F=I>w.width;if(T||V)m.style.transform="translateX(0)",T&&V?m.style.alignSelf="flex-end":F&&!T&&V?m.style.alignSelf="flex-start":F&&!V&&T&&(m.style.alignSelf="flex-end");else{m.style.alignSelf="center";const W=(A-S.width)/2-(w.left-(I-w.width)/2);m.style.transform=`translateX(${W}px)`}}},[l,e,t]);return je(y,100),f.useEffect(()=>{a.current&&(a.current.style.opacity="1")},[]),f.useLayoutEffect(()=>(p==null||p(a),()=>{g==null||g(a)}),[]),v.jsx(v.Fragment,{children:v.jsxs(He,{targetElement:d,$reverse:l,rootRef:x,children:[v.jsx(We,{}),v.jsx(Oe,{ref:R(u,a),...i,className:n+" dropdown-container",$alignSelf:o,$dropContainerCssMixin:r})]})})});pe.displayName="DropdownContainer";const fe=b(pe)`
  box-shadow: var(--admiral-box-shadow-Shadow08, ${e=>Te(e.theme.shadow["Shadow 08"])});
  border-radius: var(--admiral-border-radius-Medium, ${e=>Fe(e.theme.shape)});
  overflow: hidden;
  width: max-content;
`;fe.displayName="StyledDropdownContainer";const $=b.div.withConfig({displayName:"InputBox__FocusBox",componentId:"sc-c70185ac-0"})(["cursor:text;display:inline-flex;overflow:hidden;flex-wrap:nowrap;flex-direction:row;align-items:stretch;height:40px;padding:0;padding-inline-start:16px;padding-inline-end:16px;& *{"," line-height:40px;}&[data-size='xl']{height:56px;& *{line-height:56px;}}&[data-size='s']{height:32px;padding-inline-start:12px;padding-inline-end:12px;& *{"," line-height:32px;}}box-sizing:border-box;border-radius:4px;background:transparent;transform:translate3d(0,0,0);box-shadow:0px 0px 0px 1px "," inset;&:hover:not(:focus-within){box-shadow:0px 0px 0px 1px "," inset;}&:focus-within{box-shadow:0px 0px 0px 2px "," inset;}transition:box-shadow 0.3s ease-in-out;"],e=>e.theme.typography["Body/Body 1 Long"],e=>e.theme.typography["Body/Body 2 Long"],e=>e.theme.color["Neutral/Neutral 40"],e=>e.theme.color["Neutral/Neutral 60"],e=>e.theme.color["Primary/Primary 60 Main"]),q=$;try{$.displayName="FocusBox",$.__docgenInfo={description:"",displayName:"FocusBox",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"DefaultTheme"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"void | WebTarget"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"void | WebTarget"}}}}}catch{}try{q.displayName="InputBox",q.__docgenInfo={description:"",displayName:"InputBox",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"DefaultTheme"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"void | WebTarget"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"void | WebTarget"}}}}}catch{}const Y=b.input.withConfig({displayName:"InputLine__StyledInputLine",componentId:"sc-2adeaa54-0"})(["border:none;outline:none;appearance:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;text-overflow:ellipsis;padding:0;color:",";::placeholder{color:",";}"],e=>e.$isTmpValue?e.theme.color["Neutral/Neutral 30"]:e.theme.color["Neutral/Neutral 90"],e=>e.theme.color["Neutral/Neutral 50"]),he=b.span.withConfig({displayName:"InputLine__Visible",componentId:"sc-2adeaa54-1"})(["color:",";transition:color 0.3s ease-in-out;"],e=>e.theme.color["Neutral/Neutral 30"]),$e=b.span.withConfig({displayName:"InputLine__Invisible",componentId:"sc-2adeaa54-2"})(["color:transparent;"]),qe=b.div.withConfig({displayName:"InputLine__InputLineContainer",componentId:"sc-2adeaa54-3"})(["position:relative;display:inline-block;&:focus-within ","{color:",";}"],he,e=>e.theme.color["Neutral/Neutral 50"]),Ye=b.div.withConfig({displayName:"InputLine__MaskBox",componentId:"sc-2adeaa54-4"})(["position:absolute;pointer-events:none;top:0;bottom:0;left:0;right:0;"]),z=f.forwardRef((e,t)=>{const{className:s,dataPlaceholder:n,tmpValue:o,...r}=e,i={className:s},u=e.placeholder,a=f.useRef(null),l=f.useRef(null),c=f.useRef(null);f.useEffect(()=>{const p=a.current,g=l.current,E=c.current;function x(){const{value:y}=this,m=y.length;g&&E&&(typeof u=="string"&&u.length>0&&y.length==0?(E.innerHTML="",g.innerHTML=""):(g.innerHTML=y,E.innerHTML=(n==null?void 0:n.substring(m))||""))}if(typeof n=="string"&&p&&g&&E)return x.apply(p),p.addEventListener("input",x),()=>p.removeEventListener("input",x)},[n,u,r.value,r.defaultValue,o]);const d=typeof o=="string";return v.jsxs(qe,{...i,children:[v.jsx(Y,{ref:R(t,a),...r,$isTmpValue:d,value:d?o:r.value}),v.jsxs(Ye,{children:[v.jsx($e,{ref:l}),v.jsx(he,{ref:c})]})]})});try{Y.displayName="StyledInputLine",Y.__docgenInfo={description:"",displayName:"StyledInputLine",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"DefaultTheme"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"void | WebTarget"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"void | WebTarget"}}}}}catch{}try{z.displayName="InputLine",z.__docgenInfo={description:"",displayName:"InputLine",props:{dataPlaceholder:{defaultValue:null,description:"",name:"dataPlaceholder",required:!1,type:{name:"string"}},tmpValue:{defaultValue:null,description:"",name:"tmpValue",required:!1,type:{name:"string"}}}}}catch{}function G({icon:e,...t}){const s=e;return v.jsx(s,{...t})}const U=b(G).withConfig({displayName:"InputIconButton",componentId:"sc-9818fd62-0"})(["width:24px;[data-size='s'] &{width:20px;}& *[fill^='#']{fill:var(--admiral-color-Neutral_Neutral50,",");}[disabled] &&&{pointer-events:none;& *[fill^='#']{fill:var(--admiral-color-Neutral_Neutral30,",");}}&:hover{cursor:pointer;}&:hover *[fill^='#']{fill:var(--admiral-color-Primary_Primary70,",");}"],e=>e.theme.color["Neutral/Neutral 50"],e=>e.theme.color["Neutral/Neutral 30"],e=>e.theme.color["Primary/Primary 70"]);try{G.displayName="AnyIcon",G.__docgenInfo={description:"",displayName:"AnyIcon",props:{icon:{defaultValue:null,description:"",name:"icon",required:!0,type:{name:"FunctionComponent<SVGProps<SVGSVGElement>>"}}}}}catch{}try{U.displayName="InputIconButton",U.__docgenInfo={description:"",displayName:"InputIconButton",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"DefaultTheme"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"void | WebTarget"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"void | WebTarget"}}}}}catch{}const ze=e=>f.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",focusable:!1,...e},f.createElement("path",{fill:"#717681",fillRule:"evenodd",d:"M8.14 1.94c.35 0 .65.3.65.65v1.39h2.56V2.59c0-.35.29-.65.65-.65.35 0 .64.3.64.65v1.39h2.56V2.59c0-.35.29-.65.65-.65.35 0 .65.3.65.65v1.39h.5c1.64 0 3 1.34 3 3v10.13c0 1.67-1.34 3-3 3H7c-1.67 0-3-1.33-3-3V6.98c0-1.66 1.33-3 3-3h.48V2.59c0-.35.3-.65.66-.65m-.66 4.91V5.28H7c-.94 0-1.71.76-1.71 1.7v2.36H18.7V6.98c0-.94-.77-1.7-1.7-1.7h-.5v1.57c0 .36-.3.65-.65.65-.36 0-.65-.29-.65-.65V5.28h-2.56v1.57c0 .36-.29.65-.64.65-.36 0-.65-.29-.65-.65V5.28H8.79v1.57a.655.655 0 0 1-1.31 0m11.22 3.8H5.29v6.46c0 .94.77 1.7 1.71 1.7h10c.93 0 1.7-.76 1.7-1.7zM7.52 13.99c0-.74.61-1.34 1.35-1.34h2.33c.74 0 1.34.6 1.34 1.34v1.32c0 .75-.6 1.36-1.34 1.36H8.87c-.74 0-1.35-.61-1.35-1.36zm1.32-.03c-.01.01-.01.02-.01.03v1.32c0 .02 0 .03.01.04s.02.01.03.01h2.33c.01 0 .02 0 .03-.01s.02-.02.02-.04v-1.32c0-.01-.01-.02-.02-.03s-.02-.01-.03-.01H8.87c-.01 0-.02 0-.03.01"})),K=fe;try{K.displayName="PopoverPanel",K.__docgenInfo={description:"",displayName:"PopoverPanel",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"DefaultTheme"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"void | WebTarget"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"void | WebTarget"}}}}}catch{}const Ge=b(Ae).withConfig({displayName:"DatePicker__Calendar",componentId:"sc-c5438e8e-0"})(["border:none;box-shadow:none;"]),Ue=e=>e.format("DD.MM.YYYY"),Ke=e=>H(e,"DD.MM.YYYY"),B=f.forwardRef(({inputProps:e={},format:t=Ue,parce:s=Ke,...n},o)=>{const[r,i]=f.useState(e.value),[u,a]=f.useState(H()),[l,c]=f.useState(),[d,p]=f.useState(!1),[g,E]=f.useState(!1),x=f.useRef(null),y=f.useRef(null),[m,S]=f.useState(!1),[w,C]=f.useState("dates"),A=h=>{h.preventDefault(),g&&S(D=>!D)},I=h=>{if(w==="dates"){const D=t(h);i(D),p(!1),S(!1)}},V=h=>{c(h?t(h):void 0),w==="dates"&&p(!!h)},T=h=>{C(h),h!=="dates"&&(c(void 0),p(!1))},F=h=>{var D;S(!1),E(!1),p(!1),(D=e.onBlur)==null||D.call(e,h)},W=h=>{var D;S(!0),E(!0),(D=e.onFocus)==null||D.call(e,h)},we=h=>{var D;h.target===h.currentTarget&&h.preventDefault(),g||(D=y.current)==null||D.focus()},Se=h=>{h.key==="Enter"&&m&&(h.preventDefault(),S(!1),d&&l&&(i(l),p(!1)))},be={...n,ref:R(x,o),onMouseDown:we};f.useEffect(()=>{const h=y.current;if(h){const{value:D}=h;r!==D&&Re(y.current,{value:r})}},[r]),f.useEffect(()=>{if(m&&y.current){const h=y.current,{value:D}=h;i(D)}},[m]),f.useEffect(()=>{function h(){const{value:D}=this;p(!1),D!==r&&(i(D),S(!0))}if(y.current){const D=y.current;return D.addEventListener("input",h,!0),()=>{D.removeEventListener("input",h,!0)}}},[r]),f.useEffect(()=>{const h=s(r);h.isValid()?a(h):r||a(H())},[r]);const _e=e.ref!==void 0?R(y,e.ref):y,Ce={...e,ref:_e,onBlur:F,onFocus:W,tmpValue:d?l:void 0},Ie=s(r);return v.jsxs(q,{...be,children:[v.jsx(z,{...Ce,onKeyDown:Se}),v.jsx(U,{icon:ze,onMouseDown:A}),m&&v.jsx(K,{targetElement:x.current,alignSelf:"auto",children:v.jsx(Ge,{onViewModeChange:T,dateValue:u,onDateValueChange:h=>a(h),selectedDateValue:Ie,onSelectedDateValueChange:I,activeDateValue:s(l),onActiveDateValueChange:V})})]})});try{B.displayName="DatePicker",B.__docgenInfo={description:"",displayName:"DatePicker",props:{inputProps:{defaultValue:{value:"{}"},description:"Пропсы внутреннего инпута",name:"inputProps",required:!1,type:{name:"InputLineProps"}},format:{defaultValue:{value:"(date: Dayjs) => date.format('DD.MM.YYYY')"},description:"Функция для конвертации значение календаря в строку инпута",name:"format",required:!1,type:{name:"((date: Dayjs) => string)"}},parce:{defaultValue:{value:"(date?: string) => dayjs(date, 'DD.MM.YYYY')"},description:"Функция для конвертации строки инпута в значение календаря",name:"parce",required:!1,type:{name:"((date?: string) => Dayjs)"}},"data-size":{defaultValue:null,description:"Размеры компонента",name:"data-size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"xl"'}]}}}}}catch{}function se(e){const{anchorOffset:t=0,focusOffset:s=0}=e.ownerDocument.getSelection()||{},n=Math.min(t,s),o=Math.max(t,s);return[n,o]}function Ze(e,[t,s]){var n,o;const r=e.ownerDocument,i=r.createRange();i.setStart(e.firstChild||e,Math.min(t,((n=e.textContent)===null||n===void 0?void 0:n.length)||0)),i.setEnd(e.lastChild||e,Math.min(s,((o=e.textContent)===null||o===void 0?void 0:o.length)||0));const u=r.getSelection();u&&(u.removeAllRanges(),u.addRange(i))}class Xe{constructor(t){this.element=t,this.maxLength=1/0}get value(){return this.element.innerText.replace(/\n\n$/,`
`)}set value(t){this.element.innerHTML=t.replace(/\n$/,`

`)}get selectionStart(){return se(this.element)[0]}get selectionEnd(){return se(this.element)[1]}setSelectionRange(t,s){Ze(this.element,[t||0,s||0])}select(){this.setSelectionRange(0,this.value.length)}}function Je(e){const t=new Xe(e);return new Proxy(e,{get(s,n){if(n in t)return t[n];const o=s[n];return typeof o=="function"?o.bind(s):o},set(s,n,o,r){return Reflect.set(n in t?t:s,n,o,r)}})}const Qe=e=>e.isContentEditable?Je(e):e.querySelector("input,textarea")||e,Q={mask:/^.*$/,preprocessors:[],postprocessors:[],plugins:[],overwriteMode:"shift"};class et{constructor(){this.now=null,this.past=[],this.future=[]}undo(){const t=this.past.pop();t&&this.now&&(this.future.push(this.now),this.updateElement(t,"historyUndo"))}redo(){const t=this.future.pop();t&&this.now&&(this.past.push(this.now),this.updateElement(t,"historyRedo"))}updateHistory(t){if(!this.now){this.now=t;return}const s=this.now.value!==t.value,n=this.now.selection.some((o,r)=>o!==t.selection[r]);!s&&!n||(s&&(this.past.push(this.now),this.future=[]),this.now=t)}updateElement(t,s){this.now=t,this.updateElementState(t,{inputType:s,data:null})}}function tt(e,...t){return t.every(({value:s})=>s===e.value)}function nt(e,...t){return t.every(({value:s,selection:n})=>s===e.value&&n[0]===e.selection[0]&&n[1]===e.selection[1])}function st({value:e,selection:t},s,n){const[o,r]=t,i=typeof n=="function"?n({value:e,selection:t}):n;return{value:e,selection:i==="replace"?[o,o+s.length]:[o,r]}}function O(e){return typeof e=="string"}function oe(e,t,s,n){let o="";for(let r=t.length;r<e.length;r++){const i=e[r],u=(n==null?void 0:n.value[r])===i;if(!O(i)||i===s&&!u)return o;o+=i}return o}function me(e,t){return Array.isArray(t)?e.length===t.length&&Array.from(e).every((s,n)=>{const o=t[n];return O(o)?s===o:s.match(o)}):t.test(e)}function ot(e,t,s){let n=null,o=null;const r=Array.from(e.value).reduce((u,a,l)=>{const c=oe(t,u,a,s),d=u+c,p=t[d.length];return O(p)?d+p:a.match(p)?(n===null&&l>=e.selection[0]&&(n=d.length),o===null&&l>=e.selection[1]&&(o=d.length),d+a):d},""),i=oe(t,r,"",s);return{value:me(r+i,t)?r+i:r,selection:[n??r.length,o??r.length]}}function rt({value:e,selection:t},s){const[n,o]=t;let r=n,i=o;return{value:Array.from(e).reduce((a,l,c)=>{const d=a+l;return n===c&&(r=a.length),o===c&&(i=a.length),d.match(s)?d:a},""),selection:[r,i]}}function M(e,t,s=null){if(me(e.value,t))return e;const{value:n,selection:o}=Array.isArray(t)?ot(e,t,s):rt(e,t);return{selection:o,value:Array.isArray(t)?n.slice(0,t.length):n}}function re(e,t){if(!Array.isArray(t))return e;const[s,n]=e.selection,o=[],r=Array.from(e.value).reduce((i,u,a)=>{const l=t[a];return a===s&&o.push(i.length),a===n&&o.push(i.length),O(l)&&l===u?i:i+u},"");return o.length<2&&o.push(...new Array(2-o.length).fill(r.length)),{value:r,selection:[o[0],o[1]]}}class Z{constructor(t,s){this.initialElementState=t,this.maskOptions=s,this.value="",this.selection=[0,0];const{value:n,selection:o}=M(this.initialElementState,this.getMaskExpression(this.initialElementState));this.value=n,this.selection=o}addCharacters([t,s],n){const{value:o}=this,r=this.getMaskExpression({value:o.slice(0,t)+n+o.slice(s),selection:[t+n.length,t+n.length]}),i={value:o,selection:[t,s]},u=re(i,r),[a,l]=st(u,n,this.maskOptions.overwriteMode).selection,c=u.value.slice(0,a)+n,d=c.length,p=M({value:c+u.value.slice(l),selection:[d,d]},r,i);if(o.slice(0,a)===M({value:c,selection:[d,d]},r,i).value||nt(this,p))throw new Error("Invalid mask value");this.value=p.value,this.selection=p.selection}deleteCharacters([t,s]){if(t===s||!s)return;const{value:n}=this,o=this.getMaskExpression({value:n.slice(0,t)+n.slice(s),selection:[t,t]}),r={value:n,selection:[t,s]},i=re(r,o),[u,a]=i.selection,l=i.value.slice(0,u)+i.value.slice(a),c=M({value:l,selection:[u,u]},o,r);this.value=c.value,this.selection=c.selection}getMaskExpression(t){const{mask:s}=this.maskOptions;return typeof s=="function"?s(t):s}}class it{constructor(t){this.element=t,this.listeners=[]}listen(t,s,n){const o=s;this.element.addEventListener(t,o,n),this.listeners.push(()=>this.element.removeEventListener(t,o))}destroy(){this.listeners.forEach(t=>t())}}const _={CTRL:1,ALT:2,SHIFT:4,META:8},k={Y:89,Z:90};function L(e,t,s){return e.ctrlKey===!!(t&_.CTRL)&&e.altKey===!!(t&_.ALT)&&e.shiftKey===!!(t&_.SHIFT)&&e.metaKey===!!(t&_.META)&&e.keyCode===s}function at(e){return L(e,_.CTRL,k.Y)||L(e,_.CTRL|_.SHIFT,k.Z)||L(e,_.META|_.SHIFT,k.Z)}function ut(e){return L(e,_.CTRL,k.Z)||L(e,_.META,k.Z)}function lt({value:e,selection:t},s){const[n,o]=t;if(n!==o)return[n,o];const r=s?e.slice(n).indexOf(`
`)+1||e.length:e.slice(0,o).lastIndexOf(`
`)+1;return[s?n:r,s?r:o]}function ct({value:e,selection:t},s){const[n,o]=t;return n!==o?[n,o]:(s?[n,o+1]:[n-1,o]).map(i=>Math.min(Math.max(i,0),e.length))}const dt=/\s+$/g,pt=/^\s+/g,ie=/\s/;function ft({value:e,selection:t},s){const[n,o]=t;if(n!==o)return[n,o];if(s){const a=e.slice(n),[l]=a.match(pt)||[""],c=a.trimStart().search(ie);return[n,c!==-1?n+l.length+c:e.length]}const r=e.slice(0,o),[i]=r.match(dt)||[""],u=r.trimEnd().split("").reverse().findIndex(a=>a.match(ie));return[u!==-1?o-i.length-u:0,o]}function j(e=[]){return(t,...s)=>e.reduce((n,o)=>Object.assign(Object.assign({},n),o(n,...s)),t)}function ht(e,t){const s=Object.assign(Object.assign({},Q),t),n=j(s.preprocessors),o=j(s.postprocessors),r=typeof e=="string"?{value:e,selection:[0,0]}:e,{elementState:i}=n({elementState:r,data:""},"validation"),u=new Z(i,s),{value:a,selection:l}=o(u,r);return typeof e=="string"?a:{value:a,selection:l}}class mt extends et{constructor(t,s){super(),this.element=t,this.maskitoOptions=s,this.isTextArea=this.element.nodeName==="TEXTAREA",this.eventListener=new it(this.element),this.options=Object.assign(Object.assign({},Q),this.maskitoOptions),this.preprocessor=j(this.options.preprocessors),this.postprocessor=j(this.options.postprocessors),this.teardowns=this.options.plugins.map(n=>n(this.element,this.options)),this.updateHistory(this.elementState),this.eventListener.listen("keydown",n=>{if(at(n))return n.preventDefault(),this.redo();if(ut(n))return n.preventDefault(),this.undo()}),this.eventListener.listen("beforeinput",n=>{var o;const r=n.inputType.includes("Forward");switch(this.updateHistory(this.elementState),n.inputType){case"historyUndo":return n.preventDefault(),this.undo();case"historyRedo":return n.preventDefault(),this.redo();case"deleteByCut":case"deleteContentBackward":case"deleteContentForward":return this.handleDelete({event:n,isForward:r,selection:ct(this.elementState,r)});case"deleteWordForward":case"deleteWordBackward":return this.handleDelete({event:n,isForward:r,selection:ft(this.elementState,r),force:!0});case"deleteSoftLineBackward":case"deleteSoftLineForward":case"deleteHardLineBackward":case"deleteHardLineForward":return this.handleDelete({event:n,isForward:r,selection:lt(this.elementState,r),force:!0});case"insertCompositionText":return;case"insertReplacementText":return;case"insertLineBreak":case"insertParagraph":return this.handleEnter(n);case"insertFromPaste":case"insertText":case"insertFromDrop":default:return this.handleInsert(n,n.data||((o=n.dataTransfer)===null||o===void 0?void 0:o.getData("text/plain"))||"")}}),this.eventListener.listen("input",({inputType:n})=>{n!=="insertCompositionText"&&(this.ensureValueFitsMask(),this.updateHistory(this.elementState))}),this.eventListener.listen("compositionend",()=>{this.ensureValueFitsMask(),this.updateHistory(this.elementState)})}get elementState(){const{value:t,selectionStart:s,selectionEnd:n}=this.element;return{value:t,selection:[s||0,n||0]}}get maxLength(){const{maxLength:t}=this.element;return t===-1?1/0:t}destroy(){this.eventListener.destroy(),this.teardowns.forEach(t=>t==null?void 0:t())}updateElementState({value:t,selection:s},n={inputType:"insertText",data:null}){const o=this.elementState.value;this.updateValue(t),this.updateSelectionRange(s),o!==t&&this.dispatchInputEvent(n)}updateSelectionRange([t,s]){var n;const{element:o}=this;o.matches(":focus")&&(o.selectionStart!==t||o.selectionEnd!==s)&&((n=o.setSelectionRange)===null||n===void 0||n.call(o,t,s))}updateValue(t){this.element.value=t}ensureValueFitsMask(){this.updateElementState(ht(this.elementState,this.options))}dispatchInputEvent(t={inputType:"insertText",data:null}){globalThis.InputEvent&&this.element.dispatchEvent(new InputEvent("input",Object.assign(Object.assign({},t),{bubbles:!0,cancelable:!1})))}handleDelete({event:t,selection:s,isForward:n,force:o=!1}){const r={value:this.elementState.value,selection:s},[i,u]=r.selection,{elementState:a}=this.preprocessor({elementState:r,data:""},n?"deleteForward":"deleteBackward"),l=new Z(a,this.options),[c,d]=a.selection;l.deleteCharacters([c,d]);const p=this.postprocessor(l,r);if(!(r.value.slice(0,i)+r.value.slice(u)===p.value&&!o&&!this.element.isContentEditable)){if(t.preventDefault(),tt(r,a,l,p))return this.updateSelectionRange(n?[d,d]:[c,c]);this.updateElementState(p,{inputType:t.inputType,data:null}),this.updateHistory(p)}}handleInsert(t,s){const n=this.elementState,{elementState:o,data:r=s}=this.preprocessor({data:s,elementState:n},"insert"),i=new Z(o,this.options);try{i.addCharacters(o.selection,r)}catch{return t.preventDefault()}const[u,a]=o.selection,l=n.value.slice(0,u)+s+n.value.slice(a),c=this.postprocessor(i,n);if(c.value.length>this.maxLength)return t.preventDefault();(l!==c.value||this.element.isContentEditable)&&(t.preventDefault(),this.updateElementState(c,{data:s,inputType:t.inputType}),this.updateHistory(c))}handleEnter(t){(this.isTextArea||this.element.isContentEditable)&&this.handleInsert(t,`
`)}}function gt(e,t,s){const n=Math.min(Number(s),Math.max(Number(t),Number(e)));return e instanceof Date?new Date(n):n}function vt(e){return e.replaceAll(/\W/g,"").length}const ge=e=>{var t,s,n;return{day:((t=e.match(/d/g))===null||t===void 0?void 0:t.length)||0,month:((s=e.match(/m/g))===null||s===void 0?void 0:s.length)||0,year:((n=e.match(/y/g))===null||n===void 0?void 0:n.length)||0}};function yt(e){return{day:String(e.getDate()).padStart(2,"0"),month:String(e.getMonth()+1).padStart(2,"0"),year:String(e.getFullYear()).padStart(4,"0"),hours:String(e.getHours()).padStart(2,"0"),minutes:String(e.getMinutes()).padStart(2,"0"),seconds:String(e.getSeconds()).padStart(2,"0"),milliseconds:String(e.getMilliseconds()).padStart(3,"0")}}function Dt(e,t){return e.length<t.length?!1:e.split(/\D/).every(s=>!s.match(/^0+$/))}function ve(e,t,s){const n=vt(t);return e.replace(s,"").match(new RegExp(`(\\D*\\d[^\\d\\s]*){1,${n}}`,"g"))||[]}function ee(e,t){const s=t.replaceAll(/[^dmy]/g,""),n=e.replaceAll(/\D+/g,""),o={day:n.slice(s.indexOf("d"),s.lastIndexOf("d")+1),month:n.slice(s.indexOf("m"),s.lastIndexOf("m")+1),year:n.slice(s.indexOf("y"),s.lastIndexOf("y")+1)};return Object.fromEntries(Object.entries(o).filter(([r,i])=>!!i).sort(([r],[i])=>t.toLowerCase().indexOf(r[0])>t.toLowerCase().indexOf(i[0])?1:-1))}function Et(e,t){var s,n,o,r,i,u,a;const l=((s=e.year)===null||s===void 0?void 0:s.length)===2?`20${e.year}`:e.year,c=new Date(Number(l??"0"),Number((n=e.month)!==null&&n!==void 0?n:"1")-1,Number((o=e.day)!==null&&o!==void 0?o:"1"),Number((r=void 0)!==null&&r!==void 0?r:"0"),Number((i=void 0)!==null&&i!==void 0?i:"0"),Number((u=void 0)!==null&&u!==void 0?u:"0"),Number((a=void 0)!==null&&a!==void 0?a:"0"));return c.setFullYear(Number(l??"0")),c}const ye=", ";function N({day:e,month:t,year:s,hours:n,minutes:o,seconds:r,milliseconds:i},{dateMode:u,dateTimeSeparator:a=ye,timeMode:l}){var c;const d=((c=u.match(/y/g))===null||c===void 0?void 0:c.length)===2?s==null?void 0:s.slice(-2):s;return(u+(l?a+l:"")).replaceAll(/d+/g,e??"").replaceAll(/m+/g,t??"").replaceAll(/y+/g,d??"").replaceAll(/H+/g,n??"").replaceAll("MSS",i??"").replaceAll(/M+/g,o??"").replaceAll(/S+/g,r??"").replaceAll(/^\D+/g,"").replaceAll(/\D+$/g,"")}const De={day:31,month:12,year:9999},xt=new Date("0001-01-01"),wt=new Date("9999-12-31"),St=[":","."];function bt({dateString:e,dateModeTemplate:t,dateSegmentsSeparator:s,offset:n,selection:[o,r]}){const i=ee(e,t),u=Object.entries(i),a={};for(const[d,p]of u){const g=N(a,{dateMode:t}),E=De[d],x=g.length&&s.length,y=n+g.length+x+ge(t)[d],m=y>=o&&y===r;if(m&&Number(p)>Number(E))return{validatedDateString:"",updatedSelection:[o,r]};if(m&&Number(p)<1)return{validatedDateString:"",updatedSelection:[o,r]};a[d]=p}const l=N(a,{dateMode:t}),c=l.length-e.length;return{validatedDateString:l,updatedSelection:[o+c,r+c]}}const Ee=/[\\^$.*+?()[\]{}|]/g,_t=new RegExp(Ee.source);function xe(e){return e&&_t.test(e)?e.replaceAll(Ee,"\\$&"):e}function X(e,t,s=0){return Number(e.padEnd(t.length,"0"))<=Number(t)?{validatedSegmentValue:e,prefixedZeroesCount:s}:e.endsWith("0")?X(`0${e.slice(0,t.length-1)}`,t,s+1):X(`${e.slice(0,t.length-1)}0`,t,s)}function ae(e){return e.replaceAll(/[０-９]/g,t=>String.fromCharCode(t.charCodeAt(0)-65248))}function Ct({dateModeTemplate:e,dateSegmentSeparator:t,splitFn:s,uniteFn:n}){return({value:o,selection:r})=>{var i;const[u,a]=r,{dateStrings:l,restPart:c=""}=s(o),d=[];let p=0;l.forEach(E=>{const x=ee(E,e),m=Object.entries(x).reduce((S,[w,C])=>{const{validatedSegmentValue:A,prefixedZeroesCount:I}=X(C,`${De[w]}`);return p+=I,Object.assign(Object.assign({},S),{[w]:A})},{});d.push(N(m,{dateMode:e}))});const g=n(d,o)+(!((i=l[l.length-1])===null||i===void 0)&&i.endsWith(t)?t:"")+c;return p&&g.slice(a+p,a+p+t.length)===t&&(p+=t.length),{selection:[u+p,a+p],value:g}}}function It(){return({elementState:e,data:t})=>{const{value:s,selection:n}=e;return{elementState:{selection:n,value:ae(s)},data:ae(t)}}}function At(e,t){const s=ge(t);return Object.fromEntries(Object.entries(e).map(([n,o])=>{const r=s[n];return[n,o.length===r&&o.match(/^0+$/)?"1".padStart(r,"0"):o]}))}function Vt({dateModeTemplate:e,min:t=xt,max:s=wt,rangeSeparator:n="",dateSegmentSeparator:o="."}){return({value:r,selection:i})=>{const u=n&&r.endsWith(n),a=ve(r,e,n);let l="";for(const c of a){l+=l?n:"";const d=ee(c,e);if(!Dt(c,e)){const E=At(d,e),x=N(E,{dateMode:e}),y=c.endsWith(o)?o:"";l+=x+y;continue}const p=Et(d),g=gt(p,t,s);l+=N(yt(g),{dateMode:e})}return{selection:i,value:l+(u?n:"")}}}function Tt({dateModeTemplate:e,dateSegmentsSeparator:t,rangeSeparator:s="",dateTimeSeparator:n=ye}){return({elementState:o,data:r})=>{const i=s?new RegExp(`${s}|-`):n,u=r.split(i),a=r.includes(n)?[u[0]]:u;if(a.every(l=>l.trim().split(/\D/).filter(Boolean).length===e.split(t).length)){const l=a.map(c=>kt(c,e,t)).join(s);return{elementState:o,data:`${l}${r.includes(n)&&n+u[1]||""}`}}return{elementState:o,data:r}}}function kt(e,t,s){const n=e.split(/\D/).filter(Boolean),o=t.split(s);return n.map((i,u)=>u===o.length-1?i:i.padStart(o[u].length,"0")).join(s)}function Lt({dateModeTemplate:e,dateSegmentsSeparator:t,rangeSeparator:s=""}){return({elementState:n,data:o})=>{const{value:r,selection:i}=n;if(o===t)return{elementState:n,data:i[0]===r.length?o:""};const u=o.replaceAll(new RegExp(`[^\\d${xe(t)}${s}]`,"g"),"");if(!u)return{elementState:n,data:""};const[a,l]=i;let c=l+o.length;const d=r.slice(0,a)+u+r.slice(c),p=ve(d,e,s);let g="";const E=!!s&&d.includes(s);for(const y of p){const{validatedDateString:m,updatedSelection:S}=bt({dateString:y,dateModeTemplate:e,dateSegmentsSeparator:t,offset:g.length,selection:[a,c]});if(y&&!m)return{elementState:n,data:""};c=S[1],g+=E&&!g?m+s:m}const x=g.slice(a,c);return{elementState:{selection:i,value:g.slice(0,a)+x.split(t).map(y=>"0".repeat(y.length)).join(t)+g.slice(c)},data:x}}}function Nt(){return({elementState:e},t)=>{const{value:s,selection:n}=e;if(!s||Ft(s,n))return{elementState:e};const[o,r]=n,i=s.slice(o,r).replaceAll(/\d/g,"0"),u=s.slice(0,o)+i+s.slice(r);return t==="validation"||t==="insert"&&o===r?{elementState:{selection:n,value:u}}:{elementState:{selection:t==="deleteBackward"||t==="insert"?[o,o]:[r,r],value:u}}}}function Ft(e,[t,s]){return s===e.length}function Mt({mode:e,separator:t=".",max:s,min:n}){const o=e.split("/").join(t);return Object.assign(Object.assign({},Q),{mask:Array.from(o).map(r=>t.includes(r)?r:/\d/),overwriteMode:"replace",preprocessors:[It(),Nt(),Tt({dateModeTemplate:o,dateSegmentsSeparator:t}),Lt({dateModeTemplate:o,dateSegmentsSeparator:t})],postprocessors:[Ct({dateModeTemplate:o,dateSegmentSeparator:t,splitFn:r=>({dateStrings:[r]}),uniteFn:([r])=>r}),Vt({min:n,max:s,dateModeTemplate:o,dateSegmentSeparator:t})]})}new RegExp(`[${St.map(xe).join("")}]$`);const ue=typeof window<"u"?f.useLayoutEffect:f.useEffect;function Pt(e){return e&&typeof e=="object"&&"then"in e}const Rt=({options:e=null,elementPredicate:t=Qe}={})=>{const[s,n]=f.useState(null),[o,r]=f.useState(null),i=f.useCallback(a=>{n(a)},[]),u=f.useRef(t);return u.current=t,ue(()=>{if(!s)return;const a=t,l=a(s);Pt(l)?l.then(c=>{u.current===a&&r(c)}):r(l)},[s,t,u]),ue(()=>{if(!o||!e)return;const a=new mt(o,e);return()=>{a.destroy()}},[e,o]),i},Bt=Mt({mode:"dd/mm/yyyy"}),J=({inputProps:e={},...t})=>{const[s,n]=f.useState(e.value),o=Rt({options:Bt});return v.jsxs(Me,{children:[v.jsx(te,{children:v.jsx(B,{...t,inputProps:{...e,value:s,onInput:r=>n(r.currentTarget.value),ref:o}})}),v.jsxs(te,{children:[v.jsx(ne,{font:"Subtitle/Subtitle 2",as:"div",children:"Выбор даты"}),v.jsxs(ne,{font:"Body/Body 2 Long",as:"div",children:["Высота календаря постоянна и состоит из шести рядов чисел. Текущий месяц начинается с первого ряда и, если его даты не заходят на шестой ряд, то там ставятся пустые ячейки (Empty).",v.jsx("br",{}),v.jsx("br",{}),"Текущая дата выделяется обводкой в виде черного кружка. Ховер на дате подсвечивается обводкой синего цвета. Выбранная дата отмечается синим кружком.",v.jsx("br",{}),"При ховере на месяце, годе, стрелках вправо/влево появляются тултипы с подсказками.",v.jsx("br",{}),v.jsx("br",{}),"Клик на месяц/год открывает экран выбора месяца/года. Вернуться на экран выбора даты можно выбрав месяц/год, либо нажав на месяц/год в шапке календаря"]})]})]})};try{J.displayName="DatePickerSimpleTemplate",J.__docgenInfo={description:"",displayName:"DatePickerSimpleTemplate",props:{inputProps:{defaultValue:{value:"{}"},description:"Пропсы внутреннего инпута",name:"inputProps",required:!1,type:{name:"InputLineProps"}},format:{defaultValue:null,description:"Функция для конвертации значение календаря в строку инпута",name:"format",required:!1,type:{name:"((date: Dayjs) => string)"}},parce:{defaultValue:null,description:"Функция для конвертации строки инпута в значение календаря",name:"parce",required:!1,type:{name:"((date?: string) => Dayjs)"}},"data-size":{defaultValue:null,description:"Размеры компонента",name:"data-size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"xl"'}]}}}}}catch{}const jt=`import { T } from '@admiral-ds/react-ui';
import { DatePicker } from '@admiral-ds/date-picker';
import { maskitoDateOptionsGenerator } from '@maskito/kit';
import { useMaskito } from '@maskito/react';

import { WrapperHorizontal, WrapperVertical } from '#src/stories/common.tsx';
import { useState, type ComponentPropsWithoutRef } from 'react';

const dateOptions = maskitoDateOptionsGenerator({ mode: 'dd/mm/yyyy' });

export const DatePickerSimpleTemplate = ({
  inputProps = {},
  ...props
}: ComponentPropsWithoutRef<typeof DatePicker>) => {
  const [inputValue, setInputValue] = useState(inputProps.value);
  const maskedDateInputRef = useMaskito({ options: dateOptions });
  return (
    <WrapperHorizontal>
      <WrapperVertical>
        <DatePicker
          {...props}
          inputProps={{
            ...inputProps,
            value: inputValue,
            onInput: (e) => setInputValue(e.currentTarget.value),
            ref: maskedDateInputRef,
          }}
        />
      </WrapperVertical>

      <WrapperVertical>
        <T font="Subtitle/Subtitle 2" as="div">
          Выбор даты
        </T>
        <T font="Body/Body 2 Long" as="div">
          Высота календаря постоянна и состоит из шести рядов чисел. Текущий месяц начинается с первого ряда и, если его
          даты не заходят на шестой ряд, то там ставятся пустые ячейки (Empty).
          <br />
          <br />
          Текущая дата выделяется обводкой в виде черного кружка. Ховер на дате подсвечивается обводкой синего цвета.
          Выбранная дата отмечается синим кружком.
          <br />
          При ховере на месяце, годе, стрелках вправо/влево появляются тултипы с подсказками.
          <br />
          <br />
          Клик на месяц/год открывает экран выбора месяца/года. Вернуться на экран выбора даты можно выбрав месяц/год,
          либо нажав на месяц/год в шапке календаря
        </T>
      </WrapperVertical>
    </WrapperHorizontal>
  );
};
`,rn={title:"Admiral-2.1/Date Picker/DatePicker",component:B,parameters:{docs:{source:{language:"tsx"}}},argTypes:{}},P={render:e=>v.jsx(J,{...e}),parameters:{docs:{source:{code:jt}}},name:"Выбор даты",args:{inputProps:{placeholder:"Введите дату",dataPlaceholder:"дд.мм.гггг",value:"11."}}};var le,ce,de;P.parameters={...P.parameters,docs:{...(le=P.parameters)==null?void 0:le.docs,source:{originalSource:`{
  // обязательно для правильной работы хуков внутри темплейта
  render: props => <DatePickerSimpleTemplate {...props} />,
  parameters: {
    docs: {
      source: {
        code: DatePickerSimpleTemplateRaw
      }
    }
  },
  name: 'Выбор даты',
  args: {
    inputProps: {
      placeholder: 'Введите дату',
      dataPlaceholder: 'дд.мм.гггг',
      value: '11.'
    }
  }
}`,...(de=(ce=P.parameters)==null?void 0:ce.docs)==null?void 0:de.source}}};const an=["DatePickerCalendarSimple"];export{P as DatePickerCalendarSimple,an as __namedExportsOrder,rn as default};
